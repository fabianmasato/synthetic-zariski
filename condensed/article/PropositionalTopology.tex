%In this section, we will define the types of open and closed propositions. 
%These will allow us to define a (synthetic) topology  \cite{SyntheticTopologyLesnik} on any type.
%We will study this topology on Stone types in particular.
%
\subsection{Open and closed propositions}
In this section we will introduce a topology on the type of propositions, and 
study their logical properties.
We think of open and closed propositions respectively as countable disjunctions and conjunctions of decidable propositions.
Such a definition is universe-independent, and can be made internally.

\begin{definition}
A proposition $P$ is open (resp. closed) if there exists some $\alpha:2^\N$ such that $P \leftrightarrow \exists_{n:\mathbb N} \alpha(n) = 0$ (resp. $P \leftrightarrow \forall_{n:\mathbb N} \alpha(n) = 0$). We denote by $\Open$ and $\Closed$ the types of open and closed propositions.
\end{definition}

\begin{remark}\label{rmkOpenClosedNegation}
  The negation of an open proposition is closed, 
  and by MP (\Cref{MarkovPrinciple}), the negation of a closed proposition is open. 
  Also by MP, we have $\neg \neg P \to P$ whenever $P$ is open or closed. 
  By the negation of WLPO (\Cref{NotWLPO}), 
  not every closed proposition is decidable. 
  Therefore, not every open proposition is decidable. 
  % Both therefore and similarly can be used here, by a similar proof we can show it, or we can use that 
  % if $P$ is closed and $\neg P$ is decidable, so is $\neg \neg P = P$. 
  Every decidable proposition is both open and closed.
%  and in \Cref{ClopenDecidable} we shall see the converse. 
\end{remark}

\begin{lemma}\label{ClosedCountableConjunction}
  Closed propositions are closed under countable conjunctions.
\end{lemma}
\begin{proof}
  Let $(P_n)_{n:\N}$ be a countable family of closed propositions. 
  By countable choice, for each 
  $n:\N$ we have an $\alpha_n:2^\N $ 
  such that $P_n \leftrightarrow \forall_{m:\N} \alpha_n(m)  =0$. 
  Consider a surjection $s:\N \to \N \times \N$.
  Let 
  $$\beta(k) = \alpha_{\pi_0(s(k))}(\pi_1 (s(k))).$$
  Note that $\forall_{k:\N} \beta(k) = 0$ iff 
  $\forall_{m,n:\N}\alpha_m(n) = 0$, which happens iff $\forall_{n:\N} P_n$. 
  Hence the countable conjunction of closed propositions is closed. 
\end{proof} 

\begin{lemma}\label{OpenCountableDisjunction}
  Open propositions are closed under countable disjunctions. 
\end{lemma}
\begin{proof}
  Similar to the previous lemma. 
\end{proof}

\begin{corollary}\label{ClopenDecidable}
  If a proposition is both open and closed, it is decidable. 
\end{corollary}
\begin{proof}
  If $P$ is open and closed, by \Cref{rmkOpenClosedNegation}, $\neg P$ is open.
  By \Cref{OpenCountableDisjunction}, it follows that $P\vee \neg P$ is open, but open propositions are $\neg\neg$-stable by \Cref{rmkOpenClosedNegation} so we can conclude.
%  hence 
 % equivalent to $\neg \neg (P \vee \neg P)$ by \Cref{rmkOpenClosedNegation}.
 % As the latter proposition is provable, we may conclude $P$ is decidable. 
%  
%  If $P$ is open and closed, $P\vee \neg P$ is open, hence
%  equivalent to $\neg \neg (P \vee \neg P)$, which is provable. 
\end{proof}

\begin{lemma}\label{ClosedFiniteDisjunction} 
  Closed propositions are closed under finite disjunctions. 
\end{lemma}
\begin{proof}
  This statement is equivalent to LLPO (\Cref{LLPO})by  
  Proposition 1.4.1 of \cite{HannesDiener}. 
%  , LLPO is equivalent to the statement that 
%  for $(\phi_n)_{n:\N}, (\psi_m)_{m:\N}$ families of decidable propositions indexed over $\N$, we have
%  \begin{equation}
%    (\forall_{n:\N} \forall_{m:\N} (\phi_n \vee \psi_m) )
%    \leftrightarrow
%    ((\forall_{n:\N} \phi_n) \vee (\forall_{m:\N} \psi_m) )
%  \end{equation}
%%  $(\forall_{n:\N} \alpha(n) = 0 )\vee (\forall_{n:\N} \beta(n) = 0 )$ is closed for any $\alpha,\beta:2^\N$.
%%  By \Cref{corAlternativeLLPO}, the statement is equivalent to 
%%  $ \forall_{n:\N}  \forall_{m:\N}  (\alpha(n) = 0 \vee \beta(m) = 0)$, 
%  The latter which is a countable conjunction of decidable propositions, 
%  hence closed by \Cref{ClosedCountableConjunction}.
\end{proof}
%\begin{lemma}\label{OpenFiniteConjunction}
%  Open propositions are closed under finite conjunctions. 
%\end{lemma}
%\begin{proof}
%  We need to show that for any $\alpha,\beta:2^\N$, the following proposition is open:
%  \begin{equation}\label{eqnConjunctionOpen}
%    (\exists_{n:\N} \alpha(n) = 0 )\wedge(\exists_{n:\N} \beta(n) = 0 )
%  \end{equation}
%  Consider $\gamma:2^\N$ given by 
%  $\gamma(l) = 1$ iff there exist some $k,k'\leq l$ with 
%  $\alpha(k) = \beta(k') = 0$. 
%  As we only need to check finitely many combinations 
%  of $k,k'$, this is a decidable property for each $l:\N$ and $\gamma$ is well-defined. 
%  Then $\exists_{k:\N}\gamma(k)=0$ if and only if \Cref{eqnConjunctionOpen} holds.
%\end{proof}

\begin{lemma}\label{ClosedMarkov}
  For $(P_n)_{n:\N}$ a sequence of closed propositions, we have 
  $\neg \forall_{n:\N} P_n \leftrightarrow  \exists_{n:\N} \neg P_n$. 
\end{lemma}
\begin{proof}
We have that $P_n$ is closed and and $\exists_{n:\N} \neg P_n$ is open by \Cref{OpenCountableDisjunction}, therefore both are $\neg\neg$-stable by \Cref{rmkOpenClosedNegation} and we can conclude.
%It is always the case that $\exists_{n:\N}\neg P_n \to \neg \forall_{n:\N} P_n$. 
  %For the converse direction,
  %note that $\neg \exists_{n:\N} \neg P_n(x) \to \forall_{n:\N} \neg \neg P_n(x).$
  %By \Cref{rmkOpenClosedNegation}, $\neg \neg  P_n(x)\leftrightarrow P_n(x)$ for all $n:\N$. 
  %It follows that 
  %$\neg \forall_{n:\N} P_n(x)\to 
  %\neg \neg \exists_{n:\N} \neg P_n(x).$
  %As $\exists_{n:\N}\neg P_n(x)$ is a countable disjunction of open propositions, 
  %it is open by \Cref{OpenCountableDisjunction} and thus equivalent to 
  %$\neg\neg\exists_{n:\N} \neg P_n(x)$ by \Cref{rmkOpenClosedNegation}.
  %We conclude that $\neg \forall_{n:\N} P_n \to \exists_{n:\N} \neg P_n$ as required. 
\end{proof} 

%\begin{lemma}\label{OpenDependentSums}
%  Open propositions are closed under dependent sums.
%\end{lemma}
%\begin{proof}
%  \rednote{If we show that Open propositions are exactly the overtly discrete ones, this is implied by $\Sigma$-closure}
%  First note that for $D$ a decidable proposition, and $X:D \to \Open$,
%  by case splitting on $D$, we can see 
%  $\Sigma_{d:D} X(d)$ is open.
%%
%  Then note that for $P$ an open proposition, 
%  there exists a sequence of decidable propositions $A_n$ with 
%  $P = \exists_{n:\N} A_n $.
%%
%  So for $Y : P \to Open $, the dependent sum $\Sigma_P Y$ is given by 
%  $\exists_{n:\N} (\Sigma_{a:A_n} Y(n,a))$,
%  which is a countable disjunction of open propositions, 
%  hence open by \Cref{OpenCountableDisjunction}.
%\end{proof}
%
%We will see the same holds for closed propositions in \Cref{ClosedDependentSums}.
%
%\begin{remark}\label{ImplicationOpenClosed}
%  If $P$ is open, $P \to \bot$ is only open if $P$ is decidable, which is not in general the case. 
%  Thus $\Open$ is not closed under dependent products. Neither is $\Closed$. 
%  However, as $(P\to Q)  \to \neg \neg (\neg P \vee Q)$,
%  we have that if $P$ is open and $Q$ is closed, then $P\to Q$ is closed, and similarly $Q\to P$ is open.
%\end{remark}
\begin{lemma}\label{ImplicationOpenClosed}
  If $P$ is open and $Q$ is closed, $P\to Q$ is closed. 
  Also, if $P$ is closed and $Q$ open, then $P\to Q$ is open. 
\end{lemma}
\begin{proof}
  Assume $P$ open and $Q$ closed, the other proof is similar. 
  Note that $(\neg P \vee Q) \to (P \to Q)$ and 
  $(P\to Q)\to \neg\neg(\neg P \vee Q)$. 
  By \Cref{rmkOpenClosedNegation} it follows that 
  $(\neg P \vee Q)\leftrightarrow (P \to Q)$, and using \Cref{ClosedFiniteDisjunction}, 
  we can conclude that $P\to Q$ is closed. 
\end{proof}
%
%The following question was asked by Bas Spitters at TYPES 2024:
The following says that as soon as equality is open or closed, 
it is an apartness relation:
\begin{lemma}\label{StoneEqualityApartness}
  Whenever $X$ is a type with open or closed equality, for $x,y,z:X$ we have 
%
%  For $S:\Stone$ and $x,y,z:S$ 
%  \begin{equation}\label{Apartness}
    $
  x \neq y \to (x\neq z \vee y \neq z).
  $
%  \end{equation}
\end{lemma}
\begin{proof}
  From $x\neq y$ %, we can show that $\neg ( x = z \wedge y = z)$. 
%  This in turn implies 
  we can show $\neg \neg ( x \neq  z \vee y \neq  z)$, 
  which is equivalent to %by \Cref{rmkOpenClosedNegation} is equivalent to 
  $x\neq z \vee y \neq z$.% as required. 
%  As, $x\neq z$ and $y \neq z$ are both open propositions, by \Cref{OpenCountableDisjunction} so is their disjunction. 
%  By \Cref{rmkOpenClosedNegation}, that disjunction is double negation stable and \Cref{Apartness} follows. 
\end{proof}
%\begin{remark}
%  If \Cref{Apartness} holds in a type, we say that it's inequality is an apartness relation. 
%  By a similar proof as above, it can be shown that in our setting inequality is an apartness relation 
%  as soon as equality is open or closed. 
%\end{remark}
