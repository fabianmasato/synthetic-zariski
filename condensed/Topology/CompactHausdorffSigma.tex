\subsection{Compact Hausdorff spaces are stable under dependent sums}

\begin{lemma}\label{StoneAsClosedSubsetOfCantor}
A type $X$ is Stone iff it is merely a closed in $2^\N$.
\end{lemma}
\begin{proof}
  By \Cref{BooleAsCQuotient}, any $B:\Boole$ is can be written as $C/(r_n)_{n:\N}$.
  By \Cref{BooleEpiMono}, the quotient map induces an embedding $Sp(B)\hookrightarrow Sp(C)= 2^\N$
  and by \Cref{StoneClosedSubsets} it follows that $Sp(B)$ is closed. 
\end{proof}

%
%\begin{proof}
%Any countably presented boolean algebra $B$ is enumerable, which gives a surjective morphism:
%$$ 2[\N]\to B$$
%so that by \Cref{DualCompleteness} we merely have a closed embedding:
%$$ Sp(B)\to 2^\N$$
%\end{proof}
\rednote{Can we maybe combine the next two Lemmas?}
\begin{lemma}\label{SigmaStoneCompactHausdorff}
Assume $S:\Stone$ and $T:X\to \Stone$. Then $\Sigma_{x:S}T(x)$ is Compact Hausdorff.
\end{lemma}

\begin{proof}
  By \Cref{ClosedDependentSums} and \Cref{StoneEqualityClosed}, the identity types in $\Sigma_{x:S}T(x)$ are closed.
  By \Cref{StoneAsClosedSubsetOfCantor}, there is a surjection 
  $\Sigma_{y:2^\N}(\cdot)(y):(2^\N \to \Closed) \twoheadrightarrow \Stone$. 
  By \Cref{AxLocalChoice}, it follows we have some $S':\Stone$, a surjection $q:S'\twoheadrightarrow S$ and 
%
%  we have that $\exists_{C:2^\N\to \Closed} T_x = \Sigma_{y:2^\N}C(y)$. 
%  Using local choice we get $S':\Stone$ with a surjective map:
%$$q:S'\to S$$
%and:
%$ C : S'\to (2^\N\to\Closed)$
$ C : (S'\times 2^\N)\to\Closed$
such that for all $x:S'$ we have 
$T(q(x)) = \Sigma_{y:2^\N}C(x,y).$
This gives a surjective map:
%$$ \Sigma_{x:S'}\Sigma_{y:2^\N} C(x,y)\twoheadrightarrow \Sigma_{x:S}T(x)$$
$$ \Sigma_{c:(S'\times 2^\N)}C(c)\twoheadrightarrow \Sigma_{x:S}T(x)$$
%By \Cref{StoneClosedUnderPullback}, $S'\times 2^\N$ is Stone, 
%as $C(x,y):\Closed$ for any $(x,y):S'\times 2^\N$, by $\Cref{ClosedInStoneIsStone}$, it follows
The source is Stone by \Cref{StoneClosedUnderPullback} and \Cref{ClosedInStoneIsStone} so we can conclude.
\end{proof}

\begin{lemma}
Assume given $C:\CHaus$ and $D:X\to \CHaus$. Then $\Sigma_{x:C}D(x)$ is Compact Hausdorff.
\end{lemma}

\begin{proof}
By \Cref{ClosedDependentSums} we have that identity type in $\Sigma_{x:C}D(x)$ are closed.

We know that for any $x:C$ we have that $\exists_{T:\Stone} T\twoheadrightarrow C(x)$. Using a surjective map:
$$ S\to C$$
with $S:\Stone$ and local choice we get $S':\Stone$ with a surjective map:
$$q:S'\to C$$
such that for all $x:S'$ we have $T(x):\Stone$ and a surjective map $T(x)\to D(q(x))$. This gives a surjective map:
$$ \Sigma_{x:S'}T(x)\to \Sigma_{x:C}D(x)$$
By \Cref{SigmaStoneCompactHausdorff} we have a surjective map from a Stone space to the source so we can conclude.
\end{proof}
